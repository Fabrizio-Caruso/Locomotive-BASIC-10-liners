1DEFINT A-W:MODE 0:LOCATE 1,1:?"USE IJKL SPACE":D=500:BORDER 0:Z=.6:DEF FNRR(X)=INT(RND(1)*X):H=20:IF J=0 THEN DIM B%(D)
2U=3:M=230:N=400:W$=CHR$(207):K=1:I=M:P=M:J=0:FOR A=0 TO D:B(A)=0:NEXT:T=4:FOR O=60 TO 79:A=O+H*FNRR(H):GOSUB 10:NEXT
3LOCATE 2,1:PEN 9:?9-F;:PEN 6:?CHR$(231);:PEN 8:?U;:PEN 10:?J;R:Z=Z-0.0005:IF B(P)=36 THEN SOUND 1,D,4:J=J+9:F=F+(F>0)
4INK 0,0:Q=(P>79)*(P<440):IF RND(1)>Z THEN A=P-4+2*FNRR(5)+40*FNRR(2-(P<435))-40:I=M:T=4:GOSUB 10:R=-J*(J>R)-R*(J<=R)
5U=U*(P<460)*(P>59):A$=INKEY$:L=J AND 3:A=P:I=231:T=9+K MOD 3:GOSUB 10:S=0:Y=0:IF A$<>"" THEN S=ASC(A$):E=S AND 1
6C=S-107+E:IF SGN(C)=C THEN Y=1:A=P:I=M:T=4:GOSUB 10:P=P+C*(19*E+1):J=J+1:SOUND 1,N,3:IF J>=K*D THEN K=K+1:F=0:U=U-(U<9)
7PEN 3:LOCATE 7,2:?" MINES+ ":A=G:I=36:T=1:GOSUB 10:G=0:IF Y=1 THEN IF L=3 THEN G=60+FNRR(N):A=G:I=227:T=7:GOSUB 10
8IF S=32 THEN IF F<9 THEN I=S:FOR E=0 TO 1:A=P-1+E*2:GOSUB 10:A=P+40*E-H:GOSUB 10:NEXT:F=F+1:I=227:A=P:GOSUB 10:INK 0,3
9ON-((U>0)AND(B(P)<>M)) GOTO 3:U=U-1:SOUND 1,999,9:F=0:T=3:A=P:I=227:GOSUB 10:ON-(U>0) GOTO 3:CALL &BB18:Q=0:GOTO 1
10B(A)=I:X=1+A MOD H:LOCATE X,1+A\H:PEN T:?CHR$(I):IF Q THEN RETURN:ELSE PEN 4:LOCATE X,3:?W$:LOCATE X,24:?W$:RETURN